services:
  honeypot-redis:
    image: redis:7-alpine
    container_name: honeypot-redis
    ports:
      - "6379:6379"
    volumes:
      - honeypot-redis-data:/data
    command: ["redis-server", "--appendonly", "yes"]

  honeypot-api:
    build: .
    container_name: honeypot-api
    depends_on:
      - honeypot-redis
    ports:
      - "8000:8000"
    environment:
      API_KEY: "${API_KEY}"
      GUVI_CALLBACK_URL: "${GUVI_CALLBACK_URL}"
      SESSION_TTL_SECONDS: "${SESSION_TTL_SECONDS}"
      MAX_REPLY_CHARS: "${MAX_REPLY_CHARS}"
      MODEL_PATH: "${MODEL_PATH}"
      OPENAI_API_KEY: "${OPENAI_API_KEY}"
      OPENAI_MODEL: "gpt-5.2"
      LLM_MAX_OUTPUT_TOKENS: "${LLM_MAX_OUTPUT_TOKENS}"
      PORT: "8000"
      REDIS_HOST: "honeypot-redis"
      REDIS_PORT: "6379"
      REDIS_PASSWORD: ""
      REDIS_SSL: "false"

volumes:
  honeypot-redis-data: